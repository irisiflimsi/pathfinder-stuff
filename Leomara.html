<html>
  <head>
    <style>
      body {
	  margin: 10px 0;
	  line-height: 1.5;
	  font-size: 18px;
      }
      div.bg {
          position: fixed;
	  width: 100%;
	  height: 100%;
	  background: url("bgd.jpg") no-repeat;
	  background-size: cover;
	  z-index: -1;
      }
      div.fg {
          width: 90%; margin: auto;
      }
      table {
          margin: auto;
          text-align: center;
	  margin-top: 20px;
      }
      tr:nth-child(3n) {
	  background-color: #ccc;
      }
      th, td {
	  vertical-align: top;
	  padding: 3px 6px;
	  border: 2px solid black;
      }
      .b {
	  background-color: #aaa;
      }
      .b:hover {
	  background-color: #ccc;
      }
      
      .c {
	  text-align: left;
      }
    </style>
    <script>
      var attrs = {
	  "MU": 14, "KL": 11, "IN": 13, "CH": 11, "FF": 10, "GE": 13, "KO": 14, "KK": 14
      };
      var skills = [
	  { "n": "Klettern", "fw": 8 },
	  { "n": "Körperbeherrschung", "fw": 8 },
	  { "n": "Kraftakt", "fw": 6 },
	  { "n": "Schwimmen", "fw": 4 },
	  { "n": "Selbstbeherrschung", "fw": 8 },
	  { "n": "Sinnesschärfe", "fw": 5 },
	  { "n": "Verbergen", "fw": 2 },
	  { "n": "Betören", "fw": 0 },
	  { "n": "Einschüchtern", "fw": 4 },
	  { "n": "Gassenwissen", "fw": 0 },
	  { "n": "Menschenkenntnis", "fw": 7 },
	  { "n": "Überreden", "fw": 8 },
	  { "n": "Verkleiden", "fw": 0 },
	  { "n": "Willenskraft", "fw": 6 },
	  { "n": "Fährtensuche", "fw": 5 },
	  { "n": "Orientierung", "fw": 5 },
	  { "n": "Pflanzenkunde", "fw": 4 },
	  { "n": "Tierkunde", "fw": 5 },
	  { "n": "Wildnisleben", "fw": 6 },
	  { "n": "Geographie", "fw": 4 },
	  { "n": "Geschichtswissen", "fw": 4 },
	  { "n": "Götter & Kulte", "fw": 5 },
	  { "n": "Kriegskunst", "fw": 8 },
	  { "n": "Magiekunde", "fw": 0 },
	  { "n": "Sagen & Legenden", "fw": 6 },
	  { "n": "Alchimie", "fw": 0 },
	  { "n": "Handel", "fw": 3 },
	  { "n": "Heilkunde Gift", "fw": 0 },
	  { "n": "Heilkunde Wunden", "fw": 6 },
	  { "n": "Schlösserknacken", "fw": 0 }
      ];
      function doload() {
	  var keys = Object.keys(attrs);
	  for (var i in keys) {
	      document.getElementById(keys[i]).innerHTML = attrs[keys[i]];
	  }
	  var parent = document.getElementById("skills");
	  for (var i in skills) {
	      var tr = document.createElement("tr");
	      var td0 = document.createElement("td");
	      td0.innerHTML = skills[i]["n"];
	      td0.className = "c";
	      tr.append(td0);
	      var td1 = document.createElement("td");
	      skn = skillattrs[i]["a"].split("/");
	      td1.innerHTML = attrs[skn[0]] + "/" + attrs[skn[1]] + "/" + attrs[skn[2]];
	      tr.append(td1);
	      var td2 = document.createElement("td");
	      td2.innerHTML = skills[i]["fw"];
	      tr.append(td2);
	      var td3 = document.createElement("td");
	      td3.innerHTML = "-";
	      tr.append(td3);
	      parent.append(tr);
	  }
      }
      function reroll(n) {
	  var w = document.getElementById("roll").innerHTML.split("/");
	  var inner = (n == 0 || n == 1 ? d20() : w[0]) + "/";
	  inner += (n == 0 || n == 2 ? d20() : w[1]) + "/";
	  inner += (n == 0 || n == 3 ? d20() : w[2]);
	  document.getElementById("roll").innerHTML = inner;
	  for (i = 1; i < document.getElementById("skills").children.length; i++) {
	      recalc(inner, document.getElementById("skills").children[i].children);
	  }
      }
      function recalc(r, e) {
	  var w = r.split("/");
	  var a = e[1].innerHTML.split("/");
	  for (var i = 0; i < 3; i++) {
	      w[i] = parseInt(w[i]);
	      a[i] = parseInt(a[i]);
	  }
	  var d = [ a[0] - w[0], a[1] - w[1], a[2] - w[2] ];
	  fw = parseInt(e[2].innerHTML);
	  while (fw > 0) {
	      fw--;
	      if (d[0] == Math.min(d[0], d[1], d[2]))
		  d[0]++;
	      else if (d[1] == Math.min(d[0], d[1], d[2]))
		  d[1]++;
	      else
		  d[2]++;
	  }
	  var dmin = -Math.min(d[0], d[1], d[2]);
	  e[3].innerHTML = dmin > 0 ? "+" + dmin : dmin;
      }
      function d20() {
	  return (Math.floor(Math.random() * 20) + 1);
      }
      var skillattrs = [
	  { "n": "Klettern", "a": "MU/GE/KK" },
	  { "n": "Körperbeherrschung", "a": "GE/GE/KO" },
	  { "n": "Kraftakt", "a": "KO/KK/KK" },
	  { "n": "Schwimmen", "a": "GE/KO/KK" },
	  { "n": "Selbstbeherrschung", "a": "MU/MU/KO" },
	  { "n": "Sinnesschärfe", "a": "KL/IN/IN" },
	  { "n": "Verbergen", "a": "MU/IN/GE" },
	  { "n": "Betören", "a": "MU/CH/CH" },
	  { "n": "Einschüchtern", "a": "MU/IN/CH" },
	  { "n": "Gassenwissen", "a": "KL/IN/CH" },
	  { "n": "Menschenkenntnis", "a": "KL/IN/CH" },
	  { "n": "Überreden", "a": "MU/IN/CH" },
	  { "n": "Verkleiden", "a": "IN/CH/GE" },
	  { "n": "Willenskraft", "a": "MU/IN/CH" },
	  { "n": "Fährtensuche", "a": "MU/IN/CH" },
	  { "n": "Orientierung", "a": "KL/IN/IN" },
	  { "n": "Pflanzenkunde", "a": "KL/FF/KO" },
	  { "n": "Tierkunde", "a": "MU/MU/CH" },
	  { "n": "Wildnisleben", "a": "KL/GE/KO" },
	  { "n": "Geographie", "a": "KL/KL/IN" },
	  { "n": "Geschichtswissen", "a": "KL/KL/IN" },
	  { "n": "Götter & Kulte", "a": "KL/KL/IN" },
	  { "n": "Kriegskunst", "a": "MU/KL/IN" },
	  { "n": "Magiekunde", "a": "KL/KL/IN" },
	  { "n": "Sagen & Legenden", "a": "KL/KL/IN" },
	  { "n": "Alchimie", "a": "MU/KL/FF" },
	  { "n": "Handel", "a": "KL/IN/CH" },
	  { "n": "Heilkunde Gift", "a": "MU/KL/IN" },
	  { "n": "Heilkunde Wunden", "a": "KL/FF/FF" },
	  { "n": "Schlösserknacken", "a": "IN/FF/FF" }
      ];
    </script>
  </head>
  <body onload="doload()">
    <div class="bg"></div>
    <div class="fg">
      <table style="width:80%" id="attrs">
	<tr>
	  <th>MU</th><td id="MU"></td>
	  <th>KL</th><td id="KL"></td>
	  <th>IN</th><td id="IN"></td>
	  <th>CH</th><td id="CH"></td>
	</tr>
	<tr>
	  <th>FF</th><td id="FF"></td>
	  <th>GE</th><td id="GE"></td>
	  <th>KO</th><td id="KO"></td>
	  <th>KK</th><td id="KK"></td>
	</tr>
      </table>
      <table style="width:80%">
	<tr>
	  <th class="b" onclick="reroll(0)">Wurf</th>
	  <td id="roll">0/0/0</td>
	  <th class="b" onclick="reroll(1)">Schicksalswurf 1</th>
	  <th class="b" onclick="reroll(2)">Schicksalswurf 2</th>
	  <th class="b" onclick="reroll(3)">Schicksalswurf 3</th>
	</tr>
      </table>
      <table style="width:80%" id="skills">
	<tr>
	  <th class="c">Fertigkeit</th><th>Attribute</th><th>FW</th><th>Erfolgreich mit</th>
	</tr>
      </table>
    </div>
  </body>
</html>
